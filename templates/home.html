<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8">
    <title>BotUI</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/botui/build/botui-theme-default.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.2/css/bulma.min.css" />

	<!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/vue/latest/vue.min.js"></script>
    <script src="https://unpkg.com/botui/build/botui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>


    <link rel="stylesheet" href="{{ url_for('static', filename='main.css')}}" />


</head>
<body>
	<div class="page-title">
		<p><b>MRT Research Bot</b></p>
	</div>
	<div class="botui-app-container" id="botui-app">
	  <bot-ui></bot-ui>
	</div>

    <script>
      var botui = new BotUI('botui-app');

      function returnData(name){
      	var result = null;
      	$.ajax({
      		url: "/ask?resp="+name,
      		type: "get",
      		dataType: "html",
      		async: false,
      		success: function(data){
      			result=data;
      		}
      	});
      	return result;
      }

      function conversation() {
      	botui.message.add({
      		content: "Hello!"
      	}).then( function() {
      		return botui.action.button({
      			action: [{
      				text: "What is COVID-19?",
      				value: "one"
      			},{
      				text: "What treatments are available?",
      				value: "two"
      			},{
      				text: "What are symptoms of COVID-19?",
      				value: "three"
      			}]
      		})
      	}).then(function(res) {
      		console.log(res.value);
      		result = returnData(res.value);
      		botui.message.add({
      			content: result
      		})

      	}).then(function() {

      		conversation();
      	})
      }

      conversation()

    </script>

</body>
</html>